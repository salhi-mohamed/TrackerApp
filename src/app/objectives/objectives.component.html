<app-navbar></app-navbar>

<div class="bg-cover bg-center min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8" style="background-image: url('https://images.unsplash.com/photo-1519389950473-47ba0277781c?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxMTc3M3wwfDF8c2VhcmNofDR8fGRlc2t8ZW58MHx8fHwxNjE5Njk3NDYx&ixlib=rb-1.2.1&q=80&w=1080')">
  <div class="max-w-3xl w-full space-y-8 p-10 rounded-lg shadow-md" style="background: rgba(255, 255, 255, 0.8);">
    <div class="text-center">
      <h1 class="mt-5 text-4xl font-extrabold text-gray-900">
        <i class="fas fa-bullseye"></i> Définir des Objectifs
      </h1>
    </div>
    <form #objectiveForm="ngForm" (ngSubmit)="addObjective(objectiveForm)" class="mt-8 space-y-6">
      <div class="rounded-md shadow-sm space-y-4 text-lg">
        <div>
          <label for="objective-title" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-flag mr-2"></i>Titre de l'Objectif
          </label>
          <input id="objective-title" name="title" type="text" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" placeholder="Entrez le titre de l'objectif" [(ngModel)]="newObjective.title" #title="ngModel" required />
          <div *ngIf="title.invalid && title.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>Le titre de l'objectif est requis.
          </div>
        </div>
        <div>
          <label for="objective-description" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-info-circle mr-2"></i>Description
          </label>
          <textarea id="objective-description" name="description" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" placeholder="Entrez la description de l'objectif" [(ngModel)]="newObjective.description" #description="ngModel" required></textarea>
          <div *ngIf="description.invalid && description.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>La description de l'objectif est requise.
          </div>
        </div>
        <div>
          <label for="objective-category" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-tags mr-2"></i>Catégorie
          </label>
          <select id="objective-category" name="category" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" [(ngModel)]="newObjective.category" #category="ngModel" required>
            <option value="">Sélectionnez une catégorie</option>
            <option value="Professionnel">Professionnel</option>
            <option value="Personnel">Personnel</option>
            <option value="Santé">Santé</option>
            <option value="Autre">Autre</option>
          </select>
          <div *ngIf="category.invalid && category.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>La catégorie est requise.
          </div>
        </div>
        <div>
          <label for="objective-priority" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-exclamation-circle mr-2"></i>Priorité
          </label>
          <select id="objective-priority" name="priority" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" [(ngModel)]="newObjective.priority" #priority="ngModel" required>
            <option value="">Sélectionnez une priorité</option>
            <option value="Haute">Haute</option>
            <option value="Moyenne">Moyenne</option>
            <option value="Basse">Basse</option>
          </select>
          <div *ngIf="priority.invalid && priority.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>La priorité est requise.
          </div>
        </div>
        <div>
          <label for="objective-status" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-tasks mr-2"></i>Statut
          </label>
          <select id="objective-status" name="status" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" [(ngModel)]="newObjective.status" #status="ngModel" required>
            <option value="">Sélectionnez un statut</option>
            <option value="En cours">En cours</option>
            <option value="Complété">Complété</option>
            <option value="En attente">En attente</option>
          </select>
          <div *ngIf="status.invalid && status.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>Le statut est requis.
          </div>
        </div>
        <div>
          <label for="objective-start" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-calendar-alt mr-2"></i>Date de Début
          </label>
          <input id="objective-start" name="startDate" type="date" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" [(ngModel)]="newObjective.startDate" #startDate="ngModel" required />
          <div *ngIf="startDate.invalid && startDate.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>La date de début est requise.
          </div>
        </div>
        <div>
          <label for="objective-end" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-calendar-alt mr-2"></i>Date de Fin
          </label>
          <input id="objective-end" name="endDate" type="date" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" [(ngModel)]="newObjective.endDate" #endDate="ngModel" required />
          <div *ngIf="endDate.invalid && endDate.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>La date de fin est requise.
          </div>
        </div>
        <div>
          <label for="objective-tags" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-tag mr-2"></i>Tags
          </label>
          <input id="objective-tags" name="tags" type="text" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" placeholder="Entrez des tags séparés par des virgules" [(ngModel)]="newObjective.tags" #tags="ngModel" />
          <div *ngIf="tags.invalid && tags.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>Les tags sont requis.
          </div>
        </div>
        <div>
          <label for="objective-attachment" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-paperclip mr-2"></i>Pièces Jointes
          </label>
          <input id="objective-attachment" name="attachment" type="file" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" (change)="onFileChange($event)" />
        </div>
        <div>
          <label for="objective-reminder" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-bell mr-2"></i>Rappels
          </label>
          <div class="flex items-center">
            <input class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" type="checkbox" id="reminder-checkbox" [(ngModel)]="newObjective.reminderEnabled" name="reminderEnabled">
            <label class="ml-2 block text-lg text-gray-900" for="reminder-checkbox">
              Activer les rappels
            </label>
          </div>
          <input *ngIf="newObjective.reminderEnabled" id="objective-reminder" name="reminder" type="datetime-local" class="mt-2 appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" [(ngModel)]="newObjective.reminder" />
        </div>
        <div>
          <label for="objective-privacy" class="block text-lg font-medium text-gray-700">
            <i class="fas fa-user-secret mr-2"></i>Confidentialité
          </label>
          <select id="objective-privacy" name="privacy" class="appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-lg" [(ngModel)]="newObjective.privacy" #privacy="ngModel" required>
            <option value="">Sélectionnez une confidentialité</option>
            <option value="Public">Public</option>
            <option value="Privé">Privé</option>
          </select>
          <div *ngIf="privacy.invalid && privacy.touched" class="text-red-500 text-sm mt-1 italic">
            <i class="fas fa-exclamation-circle mr-1"></i>La confidentialité est requise.
          </div>
        </div>
      </div>
      <div>
        <button type="submit" [disabled]="isSubmitting" class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-lg font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
          <i class="fas fa-plus-circle mr-2"></i> Ajouter Objectif
          <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm ml-2" role="status" aria-hidden="true"></span>
        </button>
      </div>
    </form>
    <div *ngIf="successMessage" class="text-green-500 bg-green-100 border border-green-500 p-4 rounded-lg text-center mt-4">
      <i class="fas fa-check-circle mr-2"></i>{{ successMessage }}
    </div>
    <div *ngIf="errorMessage" class="text-red-500 bg-red-100 border border-red-500 p-4 rounded-lg text-center mt-4">
      <i class="fas fa-exclamation-triangle mr-2"></i>{{ errorMessage }}
    </div>
    <div class="card mt-4">
      <div class="card-body">
        <h2 class="card-title text-2xl font-bold mb-4"><i class="fas fa-list"></i> Objectifs</h2>
        <ul class="list-group space-y-4">
          <li class="list-group-item p-4 bg-white rounded shadow" *ngFor="let objective of objS.objectives">
            <h3 class="text-lg font-bold">{{ objective.title }}</h3>
            <p><strong>Description:</strong> {{ objective.description }}</p>
            <p><strong>Catégorie:</strong> {{ objective.category }}</p>
            <p><strong>Priorité:</strong> {{ objective.priority }}</p>
            <p><strong>Statut:</strong> {{ objective.status }}</p>
            <p><strong>Début:</strong> {{ objective.startDate }}</p>
            <p><strong>Fin:</strong> {{ objective.endDate }}</p>
            <p><strong>Tags:</strong> {{ objective.tags }}</p>
            <p *ngIf="objective.attachment"><strong>Pièce Jointe:</strong> {{ objective.attachment.name }}</p>
            <p *ngIf="objective.reminder"><strong>Rappel:</strong> {{ objective.reminder }}</p>
            <p><strong>Confidentialité:</strong> {{ objective.privacy }}</p>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>